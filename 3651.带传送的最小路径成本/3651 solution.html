<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // 方法一：动态规划
        // 时间复杂度：O((k+logmn)×mn)
        // 空间复杂度：O(mn)
        function minCost(grid, k) {
            const m = grid.length, n = grid[0].length;
            const points = [];
            for (let i = 0; i < m; i++) {
                for (let j = 0; j < n; j++) {
                    points.push([i, j]);
                }
            }
            points.sort((a, b) => grid[a[0]][a[1]] - grid[b[0]][b[1]]);
            const costs = Array.from({ length: m }, () => Array(n).fill(Number.MAX_SAFE_INTEGER));
            for (let t = 0; t <= k; t++) {
                let minCost = Number.MAX_SAFE_INTEGER;
                for (let i = 0, j = 0; i < points.length; i++) {
                    minCost = Math.min(minCost, costs[points[i][0]][points[i][1]]);
                    if (i + 1 < points.length && grid[points[i][0]][points[i][1]] === grid[points[i + 1][0]][points[i + 1][1]]) {
                        continue;
                    }
                    for (let r = j; r <= i; r++) {
                        costs[points[r][0]][points[r][1]] = minCost;
                    }
                    j = i + 1;
                }
                for (let i = m - 1; i >= 0; i--) {
                    for (let j = n - 1; j >= 0; j--) {
                        if (i === m - 1 && j === n - 1) {
                            costs[i][j] = 0;
                            continue;
                        }
                        if (i !== m - 1) {
                            costs[i][j] = Math.min(costs[i][j], costs[i + 1][j] + grid[i + 1][j]);
                        }
                        if (j !== n - 1) {
                            costs[i][j] = Math.min(costs[i][j], costs[i][j + 1] + grid[i][j + 1]);
                        }
                    }
                }
            }
            return costs[0][0];
        }

        // test
        let grid = [[1, 3, 3], [2, 5, 4], [4, 3, 5]], k = 2;
        console.log(minCost(grid, k));
    </script>
</body>

</html>