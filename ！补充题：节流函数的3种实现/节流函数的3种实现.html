<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    // 1.å®šæ—¶å™¨ç‰ˆæœ¬:é¦–æ¬¡è§¦å‘ä¸ä¼šæ‰§è¡Œï¼›åœæ­¢è§¦å‘åè¿˜ä¼šæ‰§è¡Œä¸€æ¬¡ï¼›
    function throttle1(func, wait) {
      let timer = null;
      return function (...args) {
        if (!timer) {

          timer = setTimeout(() => {
            timer = null;
            func(...args);
          }, wait);
        }
      }
    }

    // 2.æ—¶é—´æˆ³ç‰ˆæœ¬:é¦–æ¬¡è§¦å‘ç«‹å³æ‰§è¡Œï¼Œåœæ­¢è§¦å‘åå°±ä¸ä¼šå†æ‰§è¡Œï¼›
    function throttle2(func, wait) {
      // å¯¹æ¯”æ—¶é—´æˆ³ï¼Œåˆå§‹åŒ–ä¸º0åˆ™é¦–æ¬¡è§¦å‘ç«‹å³æ‰§è¡Œ
      let previous = 0;
      return function (...args) {
        let context = this;
        let now = new Date().getTime();
        // é—´éš”å¤§äºwaitåˆ™æ‰§è¡Œ func å¹¶æ›´æ–°å¯¹æ¯”æ—¶é—´æˆ³
        if (now - previous > wait) {
          func.apply(context, args);
          previous = now;
        }
      }
    }

    // 3.èåˆå‰ä¸¤ç§ æ—¶é—´æˆ³+å®šæ—¶å™¨ç‰ˆæœ¬ï¼š é¦–æ¬¡è§¦å‘ç«‹å³æ‰§è¡Œï¼Œåœæ­¢åä¼šå†æ‰§è¡Œä¸€æ¬¡
    function throttle3(func, wait) {
      let timeout;
      let previous = 0;
      return function (...args) {
        let context = this;
        let now = new Date().getTime();
        // è·ç¦»ä¸‹æ¬¡å‡½æ•°æ‰§è¡Œçš„å‰©ä½™æ—¶é—´
        let remaining = wait - (now - previous);
        // å¦‚æœæ— å‰©ä½™æ—¶é—´æˆ–ç³»ç»Ÿæ—¶é—´ä¿®æ”¹
        if (remaining <= 0 || remaining > wait) {
          // å¦‚æœå®šæ—¶å™¨è¿˜å­˜åœ¨ åˆ™æ¸…é™¤å¹¶ç½®ä¸ºnull
          if (timeout) {
            clearTimeout(timeout);
            timeout = null;
          }
          // æ›´æ–°å¯¹æ¯”æ—¶é—´æˆ³å¹¶æ‰§è¡Œå‡½æ•°
          previous = now;
          func.apply(context, args);
        } else if (!timeout) {
          // å¦‚æœæœ‰å‰©ä½™æ—¶é—´ä½†å®šæ—¶å™¨ä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®å®šæ—¶å™¨
          // remainingæ¯«ç§’åæ‰§è¡Œå‡½æ•°ï¼Œæ›´æ–°å¯¹æ¯”æ—¶é—´æˆ³ å¹¶å°†å®šæ—¶å™¨ç½®ä¸ºnull
          timeout = setTimeout(() => {
            previous = new Date().getTime();
            timeout = null;
            func.apply(context, args);
          }, remaining)
        }
      }
    }

    // test
    const func = () => {
      console.log("ğŸŠ")
    }
    const test1 = throttle1(func, 3000);
    const test2 = throttle2(func, 3000);
    const test3 = throttle3(func, 3000);

    document.onmousemove = () => {
      // func();
      // test1();
      // test2();
      test3();
    }
  </script>
</body>

</html>